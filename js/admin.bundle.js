/*! For license information please see admin.bundle.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,s,r,o,i=[],c=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=r.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){l=!0,s=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw s}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function r(n,a,s,r){var o=a&&a.prototype instanceof l?a:l,d=Object.create(o.prototype);return i(d,"_invoke",function(n,a,s){var r,o,i,l=0,d=s||[],u=!1,m={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return r=t,o=0,i=e,m.n=n,c}};function v(n,a){for(o=n,i=a,t=0;!u&&l&&!s&&t<d.length;t++){var s,r=d[t],v=m.p,h=r[2];n>3?(s=h===a)&&(i=r[(o=r[4])?5:(o=3,3)],r[4]=r[5]=e):r[0]<=v&&((s=n<2&&v<r[1])?(o=0,m.v=a,m.n=r[1]):v<h&&(s=n<3||r[0]>a||a>h)&&(r[4]=n,r[5]=a,m.n=h,o=0))}if(s||n>1)return c;throw u=!0,a}return function(s,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&v(d,h),o=d,i=h;(t=o<2?e:i)||!u;){r||(o?o<3?(o>1&&(m.n=-1),v(o,i)):m.n=i:m.v=i);try{if(l=2,r){if(o||(s="next"),t=r[s]){if(!(t=t.call(r,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,o<2&&(o=0)}else 1===o&&(t=r.return)&&t.call(r),o<2&&(i=TypeError("The iterator does not provide a '"+s+"' method"),o=1);r=e}else if((t=(u=m.n<0)?i:n.call(a,m))!==c)break}catch(t){r=e,o=1,i=t}finally{l=1}}return{value:t,done:u}}}(n,s,r),!0),d}var c={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var m=[][a]?t(t([][a]())):(i(t={},a,function(){return this}),t),v=u.prototype=l.prototype=Object.create(m);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,i(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e}return d.prototype=u,i(v,"constructor",u),i(u,"constructor",d),d.displayName="GeneratorFunction",i(u,s,"GeneratorFunction"),i(v),i(v,s,"Generator"),i(v,a,function(){return this}),i(v,"toString",function(){return"[object Generator]"}),(o=function(){return{w:r,m:h}})()}function i(e,t,n,a){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}i=function(e,t,n,a){if(t)s?s(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n;else{var r=function(t,n){i(e,t,function(e){return this._invoke(t,n,e)})};r("next",0),r("throw",1),r("return",2)}},i(e,t,n,a)}function c(e,t,n,a,s,r,o){try{var i=e[r](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(a,s)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(a,s){var r=e.apply(t,n);function o(e){c(r,a,s,o,i,"next",e)}function i(e){c(r,a,s,o,i,"throw",e)}o(void 0)})}}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,u(a.key),a)}}function u(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var m=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authToken=localStorage.getItem("adminToken"),this.isAuthenticated=!1,this.currentTab="dashboard",this.token=null,this.charts={},this.listenersAttached=!1,this.currentFilters={}},n=[{key:"addAuthHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.authToken||localStorage.getItem("adminToken");return t&&(e.Authorization="Bearer ".concat(t)),e["Content-Type"]="application/json",e}},{key:"login",value:(L=l(o().m(function e(t,n){var a,s,r;return o().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})});case 1:return a=e.v,e.n=2,a.json();case 2:if(!(s=e.v).success){e.n=3;break}return this.authToken=s.token,this.isAuthenticated=!0,localStorage.setItem("adminToken",s.token),e.a(2,{success:!0,token:s.token});case 3:return e.a(2,{success:!1,message:s.message});case 4:e.n=6;break;case 5:return e.p=5,r=e.v,console.error("Erro no login:",r),e.a(2,{success:!1,message:"Erro de conexão"});case 6:return e.a(2)}},e,this,[[0,5]])})),function(e,t){return L.apply(this,arguments)})},{key:"logout",value:(D=l(o().m(function e(){var t,n,a,s=this;return o().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,!this.authToken){e.n=1;break}return e.n=1,fetch("/api/auth/logout",{method:"POST",headers:this.addAuthHeaders()});case 1:e.n=3;break;case 2:e.p=2,a=e.v,console.error("Erro no logout:",a);case 3:return e.p=3,this.authToken=null,this.isAuthenticated=!1,localStorage.removeItem("adminToken"),t=document.getElementById("username"),n=document.getElementById("password"),t&&(t.value="admin"),n&&(n.value="password"),this.clearLoginMessages(),this.showLoginScreen(),setTimeout(function(){s.setupLoginForm()},100),window.location.reload(),e.f(3);case 4:return e.a(2)}},e,this,[[0,2,3,4]])})),function(){return D.apply(this,arguments)})},{key:"verifyToken",value:(E=l(o().m(function e(){var t,n,a;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.authToken){e.n=1;break}return e.a(2,!1);case 1:return e.p=1,e.n=2,fetch("/api/auth/verify",{headers:this.addAuthHeaders()});case 2:return t=e.v,e.n=3,t.json();case 3:return n=e.v,e.a(2,n.success);case 4:return e.p=4,a=e.v,console.error("Erro ao verificar token:",a),e.a(2,!1)}},e,this,[[1,4]])})),function(){return E.apply(this,arguments)})},{key:"showLoginScreen",value:function(){document.querySelector(".login-container").style.display="flex",document.querySelector(".admin-panel").style.display="none"}},{key:"showAdminPanel",value:function(){document.querySelector(".login-container").style.display="none",document.querySelector(".admin-panel").style.display="block"}},{key:"initAuth",value:(k=l(o().m(function e(){var t,n;return o().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,this.isAuthenticated=!1,this.authToken=null,!(t=localStorage.getItem("adminToken"))){e.n=3;break}return this.authToken=t,e.n=1,this.verifyToken();case 1:if(!e.v){e.n=2;break}return this.isAuthenticated=!0,this.showAdminPanel(),this.init(),e.a(2);case 2:localStorage.removeItem("adminToken"),this.authToken=null;case 3:this.showLoginScreen(),this.setupLoginForm(),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Erro na inicialização da autenticação:",n),this.showLoginScreen(),this.setupLoginForm();case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return k.apply(this,arguments)})},{key:"setupLoginForm",value:function(){var e=this,t=document.querySelector(".login-form");if(t){var n=document.getElementById("username"),a=document.getElementById("password"),s=t.querySelector(".login-btn");t.addEventListener("submit",function(){var t=l(o().m(function t(r){var i,c,l;return o().w(function(t){for(;;)switch(t.n){case 0:if(r.preventDefault(),i=n.value.trim(),c=a.value,i&&c){t.n=1;break}return e.showLoginError("Preencha todos os campos"),t.a(2);case 1:return s.disabled=!0,s.innerHTML='<span class="spinner"></span> Entrando...',t.n=2,e.login(i,c);case 2:(l=t.v).success?(e.isAuthenticated=!0,e.authToken=l.token,localStorage.setItem("adminToken",l.token),e.showAdminPanel(),e.init()):(e.showLoginError(l.message||"Erro no login"),s.disabled=!1,s.textContent="Entrar");case 3:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}())}}},{key:"showLoginError",value:function(e){this.clearLoginMessages();var t=document.createElement("div");t.className="error-message",t.textContent=e,document.querySelector(".login-form").appendChild(t)}},{key:"clearLoginMessages",value:function(){document.querySelectorAll(".error-message, .success-message").forEach(function(e){return e.remove()})}},{key:"init",value:function(){this.isAuthenticated&&this.authToken&&(this.setupTabs(),this.setupEventListeners(),this.loadDashboard())}},{key:"setupTabs",value:function(){var e=this,t=document.querySelectorAll("[data-tab]");t.forEach(function(n){n.addEventListener("click",function(a){a.preventDefault();var s=n.getAttribute("data-tab");e.showTab(s),t.forEach(function(e){return e.classList.remove("active")}),n.classList.add("active")})})}},{key:"showTab",value:function(e){var t=this;document.querySelectorAll(".tab-content").forEach(function(e){e.style.display="none"});var n=document.getElementById(e);n&&(n.style.display="block",this.currentTab=e,"dashboard"===e&&this.loadDashboard(),setTimeout(function(){switch(e){case"reservations":t.loadReservations();break;case"contacts":t.loadContacts();break;case"stats":t.loadStats()}},100))}},{key:"setupEventListeners",value:function(){var e=this;this.listenersAttached||(document.body.addEventListener("click",function(t){var n=t.target.closest(".modal-overlay");if(n&&t.target===n)return n.style.display="none",n.classList.remove("active"),void document.body.classList.remove("modal-open");if(t.target.closest(".view-recent-contact-btn")){var a=t.target.closest(".activity-item");if(a){var s=a.dataset.contactId;s&&e.viewMessage(s)}}else{var r=t.target.closest(".activity-item");if(!r||t.target.closest("button")){var o=t.target.closest("button, a");if(o)if(o.matches(".view-reservation-details"))e.viewReservationDetails(o.dataset.id);else if(o.matches(".view-message"))e.viewMessage(o.dataset.id);else if(o.matches(".delete-item"))e.deleteItem(o.dataset.id,o.dataset.type);else{if(o.matches(".logout-btn"))return t.preventDefault(),void e.logout();if(o.matches(".modal-close")){var i=o.closest(".modal-overlay");i&&e.closeModal(i.id)}else if(o.matches(".btn-confirm")){var c=o.closest(".modal-overlay");if(c){var l=c.dataset,d=l.id,u=l.type;d&&u&&e.performDelete(d,u)}}}}else{var m=r.dataset.contactId;m&&e.viewMessage(m)}}}),document.body.addEventListener("change",function(t){if(t.target.classList.contains("status-select")){var n=t.target.dataset.id,a=t.target.value;e.updateReservationStatus(n,a)}}),this.listenersAttached=!0)}},{key:"loadDashboard",value:(w=l(o().m(function e(){var t,n,a;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.isAuthenticated&&this.authToken){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,fetch("/api/stats",{headers:this.addAuthHeaders()});case 2:return t=e.v,e.n=3,t.json();case 3:if(!(n=e.v).success){e.n=4;break}return this.updateDashboardStats(n.stats),e.n=4,this.loadRecentActivity();case 4:e.n=6;break;case 5:e.p=5,a=e.v,console.error("Erro ao carregar dashboard:",a);case 6:return e.a(2)}},e,this,[[1,5]])})),function(){return w.apply(this,arguments)})},{key:"updateDashboardStats",value:function(e){var t,n={totalReservations:document.getElementById("totalReservations"),pendingReservations:document.getElementById("pendingReservations"),totalContacts:document.getElementById("totalContacts"),monthlyRevenue:document.getElementById("monthlyRevenue")};function a(e,t,n,a){var s=document.querySelector(e);if(s){s.parentElement.classList.remove("trend-green","trend-yellow","trend-red");var r="trend-green",o="";t>=n.green?(r="trend-green",o=a.green):t>=n.yellow?(r="trend-yellow",o=a.yellow):(r="trend-red",o=a.red),s.parentElement.classList.add(r),s.textContent=o}}n.totalReservations&&(n.totalReservations.textContent=e.totalReservations||0),n.pendingReservations&&(n.pendingReservations.textContent=e.pendingReservations||0),n.totalContacts&&(n.totalContacts.textContent=e.totalContacts||0),n.monthlyRevenue&&(n.monthlyRevenue.textContent=e.confirmedReservations||0),"number"==typeof e.newReservationsLast30Days&&a("#totalReservations ~ .label + .trend span:last-child",e.newReservationsLast30Days,{green:10,yellow:1},{green:"Crescimento (+".concat(e.newReservationsLast30Days," este mês)"),yellow:"Estável (+".concat(e.newReservationsLast30Days," este mês)"),red:"Sem novas reservas"}),"number"==typeof e.newContactsLast30Days&&a("#totalContacts ~ .label + .trend span:last-child",e.newContactsLast30Days,{green:10,yellow:1},{green:"Ótima procura (+".concat(e.newContactsLast30Days," este mês)"),yellow:"Procura moderada (+".concat(e.newContactsLast30Days," este mês)"),red:"Sem novos contatos"}),"number"==typeof e.effectivenessRate&&a("#monthlyRevenue ~ .label + .trend span:last-child",e.effectivenessRate,{green:70,yellow:40},{green:"Alta efetivação",yellow:"Pode melhorar",red:"Baixa efetivação"});var s=null===(t=n.pendingReservations)||void 0===t?void 0:t.closest(".stats-card"),r=null==s?void 0:s.querySelector(".trend span:last-child");if(s&&r){s.classList.remove("trend-green","trend-yellow","trend-red");var o="trend-green",i="Nenhuma pendência!",c=e.pendingReservations||0;0===c?(o="trend-green",i="Nenhuma pendência!"):c<5?(o="trend-yellow",i="Poucas pendências"):(o="trend-red",i="Atenção: muitas pendências!"),s.classList.add(o),r.textContent=i,s.style.cursor="pointer",s.onclick=function(){document.querySelector('.nav-link[data-tab="reservations"]').click()}}var l=document.getElementById("cancellation-rate-indicator");if(l&&e.reservationStatusCount){var d=Object.values(e.reservationStatusCount).reduce(function(e,t){return e+t},0),u=e.reservationStatusCount.cancelada||0;if(d>0&&u>0){var m=(u/d*100).toFixed(1);l.innerHTML='\n          <div class="data-list-item" style="display: flex; align-items: center; gap: 0.7rem;">\n            <span style="font-weight: 800; font-size: 2.7rem; color: var(--danger-color); line-height: 1;">'.concat(m,'%</span>\n            <span style="color: #64748b; font-size: 1.05rem; font-weight: 600;">').concat(u," cancelamentos</span>\n          </div>\n        ")}else l.innerHTML="<div class='empty-state'><i class='fas fa-ban' style='font-size: 1.2rem;'></i><p style='font-size: 0.98rem;'>Nenhum cancelamento registrado.</p></div>"}}},{key:"loadRecentActivity",value:(b=l(o().m(function e(){var t,n,a,s,r,i=this;return o().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/api/reservations",{headers:this.addAuthHeaders(),cache:"no-store"});case 1:return t=e.v,e.n=2,t.json();case 2:return(n=e.v).success&&(this.displayRecentReservations(n.reservations.slice(0,5)),setTimeout(function(){document.querySelectorAll(".reservation-activity-item").forEach(function(e){e.addEventListener("click",function(t){var n=e.getAttribute("data-reservation-id");n&&i.viewReservationDetails(n)})})},100)),e.n=3,fetch("/api/contacts",{headers:this.addAuthHeaders(),cache:"no-store"});case 3:return a=e.v,e.n=4,a.json();case 4:(s=e.v).success&&this.displayRecentContacts(s.contacts.slice(0,5)),e.n=6;break;case 5:e.p=5,r=e.v,console.error("Erro ao carregar atividade recente:",r);case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return b.apply(this,arguments)})},{key:"displayRecentReservations",value:function(e){var t=this,n=document.getElementById("recentReservations");n&&(e&&0!==e.length?n.innerHTML=e.map(h).map(function(e){var n=e.guests||0,a="".concat(n," ").concat(1==n?"pessoa":"pessoas");return'\n      <div class="activity-item reservation-activity-item" data-reservation-id="'.concat(e.id,'" style="display: flex; align-items: stretch;">\n        <div class="activity-icon"><i class="fas fa-ship"></i></div>\n        <div class="activity-content" style="flex:1; display: flex; flex-direction: column; justify-content: center;">\n          <div class="reservation-row-top" style="font-weight: 600; color: #1e293b; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">').concat(t.escapeHtml(e.name),'</div>\n          <div class="reservation-row-bottom" style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.95em; margin-top: 2px;">\n            <span class="text-muted"><i class="fas fa-calendar-alt"></i> ').concat(e.date?new Date(e.date).toLocaleDateString("pt-BR"):"-",'</span>\n            <span class="text-muted"><i class="fas fa-map-marker-alt"></i> ').concat(t.escapeHtml(e.destination),'</span>\n            <span class="text-muted"><i class="fas fa-user-friends"></i> ').concat(a,'</span>\n          </div>\n        </div>\n        <div class="reservation-status-col" style="display: flex; align-items: center; justify-content: flex-end; min-width: 90px;">\n          <span class="status-badge status-').concat(e.status,'">').concat(t.getStatusText(e.status),"</span>\n        </div>\n      </div>\n    ")}).join(""):n.innerHTML='<div class="empty-state">Nenhuma reserva recente.</div>')}},{key:"displayRecentContacts",value:function(e){var t=this,n=document.getElementById("recentContacts");n&&(e&&0!==e.length?n.innerHTML=e.slice(0,5).map(function(e){return'\n      <div class="activity-item" data-contact-id="'.concat(e.id,'">\n        <div class="activity-icon"><i class="fas fa-envelope"></i></div>\n        <div class="activity-content">\n          <strong>').concat(t.escapeHtml(e.name),"</strong>\n          <span>").concat(t.escapeHtml(e.email),'</span>\n        </div>\n        <div class="activity-actions">\n          <button class="btn-modern btn-primary-modern btn-sm view-recent-contact-btn">Ver</button>\n        </div>\n      </div>\n    ')}).join(""):n.innerHTML='<div class="empty-state">Nenhum contato recente.</div>')}},{key:"loadReservations",value:(g=l(o().m(function e(t){var n,a,r,i,c;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.isAuthenticated&&this.authToken){e.n=1;break}return e.a(2);case 1:return t||(t=this.currentFilters||{}),this.currentFilters=s({},t),e.p=2,n="/api/reservations",a=[],t.status&&a.push("status=".concat(encodeURIComponent(t.status))),t.destination&&a.push("destination=".concat(encodeURIComponent(t.destination))),a.length&&(n+="?"+a.join("&")),e.n=3,fetch(n,{headers:this.addAuthHeaders(),cache:"no-store"});case 3:return r=e.v,e.n=4,r.json();case 4:(i=e.v).success?(this.showLoading("reservationsList"),this.displayReservations(i.reservations)):this.showError("Erro ao carregar reservas"),e.n=6;break;case 5:e.p=5,c=e.v,console.error("Erro ao carregar reservas:",c),this.showError("Erro ao carregar reservas");case 6:return e.a(2)}},e,this,[[2,5]])})),function(e){return g.apply(this,arguments)})},{key:"showLoading",value:function(e){var t=document.getElementById(e);t&&(t.innerHTML='\n            <div class="loading">\n                <div class="spinner"></div>\n                <span>Carregando...</span>\n            </div>\n        ')}},{key:"displayReservations",value:function(e){var t=this,n=document.getElementById("reservationsList");if(n){var a='\n      <div class="table-responsive">\n        <table class="table-modern" id="reservations-table">\n          <thead>\n            <tr>\n              <th>Nome</th>\n              <th>Destino</th>\n              <th>Data</th>\n              <th>Pessoas</th>\n              <th>Status</th>\n              <th class="text-right" style="position: relative; white-space: nowrap;">\n                Ações\n                <button id="filterDropdownBtn" type="button" style="background: none; border: none; box-shadow: none; padding: 0; margin: 0; cursor: pointer;">\n                  <i class="fas fa-sliders-h" style="font-size: 1.2em;"></i>\n                </button>\n                <div id="filterDropdown" class="dropdown-menu" style="display: none; padding: 18px 12px 12px 12px; position: absolute; right: 0; left: auto; top: 100%; z-index: 1000;">\n                  <form id="filterForm" autocomplete="off">\n                    <div class="form-group">\n                      <label for="filterStatus">Status</label>\n                      <select id="filterStatus" class="form-control">\n                        <option value="">Todos</option>\n                        <option value="pendente">Pendente</option>\n                        <option value="confirmada">Confirmada</option>\n                        <option value="cancelada">Cancelada</option>\n                      </select>\n                    </div>\n                    <div class="form-group">\n                      <label for="filterDestination">Destino</label>\n                      <select id="filterDestination" class="form-control">\n                        <option value="">Todos</option>\n                        <option value="Cabo Frio">Cabo Frio</option>\n                        <option value="Arraial do Cabo">Arraial do Cabo</option>\n                        <option value="Armação de Búzios">Armação de Búzios</option>\n                      </select>\n                    </div>\n                    <div class="d-flex justify-content-between mt-3">\n                      <button type="submit" class="btn-modern btn-primary-modern">Aplicar</button>\n                      <button type="button" id="clearFiltersBtn" class="btn-modern btn-secondary-modern">Limpar</button>\n                    </div>\n                  </form>\n                </div>\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n    ';e&&0!==e.length?a+=e.map(h).map(function(e){return'\n          <tr data-id="'.concat(e.id,'">\n              <td>').concat(t.escapeHtml(e.name),"</td>\n              <td>").concat(t.escapeHtml(e.destination),"</td>\n              <td>").concat(new Date(e.date).toLocaleDateString(),"</td>\n              <td>").concat(e.guests,"</td>\n              <td>\n                  ").concat(t.createStatusDropdown(e.id,e.status),'\n              </td>\n              <td class="text-right">\n                  <button class="btn-modern btn-primary-modern btn-sm view-reservation-details" data-id="').concat(e.id,'">\n                      <i class="fas fa-eye"></i> Detalhes\n                  </button>\n                  <button class="btn-modern btn-danger-modern btn-sm delete-item" data-id="').concat(e.id,'" data-type="reservation">\n                      <i class="fas fa-trash"></i> Excluir\n                  </button>\n              </td>\n          </tr>\n      ')}).join(""):a+='<tr><td colspan="6" class="text-center">Nenhuma reserva encontrada.</td></tr>',a+="</tbody></table></div>",n.innerHTML=a;var s=document.getElementById("filterDropdownBtn"),r=document.getElementById("filterDropdown"),o=document.getElementById("filterForm"),i=document.getElementById("clearFiltersBtn"),c=document.getElementById("filterStatus"),l=document.getElementById("filterDestination");c&&this.currentFilters&&this.currentFilters.status&&(c.value=this.currentFilters.status),l&&this.currentFilters&&this.currentFilters.destination&&(l.value=this.currentFilters.destination),s&&r&&(s.addEventListener("click",function(e){e.stopPropagation(),r.style.display="block"===r.style.display?"none":"block"}),document.addEventListener("click",function e(t){r.contains(t.target)||t.target===s||(r.style.display="none",document.removeEventListener("click",e))})),o&&o.addEventListener("submit",function(e){e.preventDefault(),r.style.display="none";var t=c.value,n=l.value;window.adminPanel.loadReservations({status:t,destination:n})}),i&&i.addEventListener("click",function(){c.value="",l.value="",r.style.display="none",window.adminPanel.currentFilters={},window.adminPanel.loadReservations({})})}else console.error("Elemento #reservationsList não encontrado.")}},{key:"createStatusDropdown",value:function(e,n){var a=(n||"").toLowerCase(),s=Object.entries({pendente:"Pendente",confirmada:"Confirmada",cancelada:"Cancelada"}).map(function(e){var n=t(e,2),s=n[0],r=n[1],o=s===a?"selected":"";return'<option value="'.concat(s,'" ').concat(o,">").concat(r,"</option>")}).join("");return'\n        <select class="status-select" data-id="'.concat(e,'" data-status="').concat(a,'">\n            ').concat(s,"\n        </select>\n    ")}},{key:"createStatusButtons",value:function(e){var t="";return t+='<span class="badge badge-info">'.concat(this.escapeHtml(e),"</span>"),["Pendente","Confirmada","Cancelada"].forEach(function(n){n.toLowerCase()!==e.toLowerCase()&&(t+='<button class="btn btn-sm btn-outline-secondary change-status-btn ml-1" data-status="'.concat(n,'">').concat(n,"</button>"))}),t}},{key:"updateReservationStatus",value:(y=l(o().m(function e(t,n){var a,s,r,i=this;return o().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/api/reservations/".concat(t,"/status"),{method:"PUT",headers:this.addAuthHeaders({"Content-Type":"application/json"}),body:JSON.stringify({status:n})});case 1:return a=e.v,e.n=2,a.json();case 2:s=e.v,a.ok&&s.success?(this.showSuccess("Status atualizado para ".concat(n,".")),setTimeout(l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i.loadReservations();case 1:return e.n=2,i.loadDashboard();case 2:return e.a(2)}},e)})),200)):this.showError(s.message||"Falha ao atualizar status."),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Erro ao atualizar status da reserva:",r),this.showError("Erro de rede ao atualizar status.");case 4:return e.a(2)}},e,this,[[0,3]])})),function(e,t){return y.apply(this,arguments)})},{key:"loadContacts",value:(p=l(o().m(function e(){var t,n,a,s;return o().w(function(e){for(;;)switch(e.n){case 0:return this.showLoading("contactsList"),e.p=1,e.n=2,fetch("/api/contacts",{headers:this.addAuthHeaders()});case 2:if((t=e.v).ok){e.n=3;break}throw new Error("Erro na rede: ".concat(t.statusText));case 3:return e.n=4,t.json();case 4:if(!(n=e.v).success){e.n=5;break}this.displayContacts(n.contacts),e.n=6;break;case 5:throw new Error(n.message||"Falha ao obter dados de contatos");case 6:e.n=8;break;case 7:e.p=7,s=e.v,console.error("Erro ao carregar contatos:",s),this.showError("Não foi possível carregar os contatos."),(a=document.getElementById("contactsList"))&&(a.innerHTML='<div class="alert alert-danger">Erro ao carregar contatos.</div>');case 8:return e.a(2)}},e,this,[[1,7]])})),function(){return p.apply(this,arguments)})},{key:"displayContacts",value:function(e){var t=this,n=document.getElementById("contactsList");if(n)if(e&&0!==e.length){var a='\n    <div class="table-responsive">\n      <table class="table-modern" id="contacts-table">\n          <thead>\n              <tr>\n                  <th>Nome</th>\n                  <th>Email</th>\n                  <th>Telefone</th>\n                  <th>Data</th>\n                  <th class="text-right">Ações</th>\n              </tr>\n          </thead>\n          <tbody>\n              '.concat(e.map(function(e){return'\n                  <tr data-id="'.concat(e.id,'">\n                      <td>').concat(t.escapeHtml(e.name),"</td>\n                      <td>").concat(t.escapeHtml(e.email),"</td>\n                      <td>").concat(t.escapeHtml(e.phone||"N/A"),"</td>\n                      <td>").concat(new Date(e.createdAt||e.timestamp).toLocaleDateString(),'</td>\n                      <td class="text-right">\n                          <button class="btn-modern btn-primary-modern btn-sm view-message" data-id="').concat(e.id,'">\n                              <i class="fas fa-eye"></i> Visualizar\n                          </button>\n                          <button class="btn-modern btn-danger-modern btn-sm delete-item" data-id="').concat(e.id,'" data-type="contact">\n                              <i class="fas fa-trash"></i> Excluir\n                          </button>\n                      </td>\n                  </tr>\n              ')}).join(""),"\n          </tbody>\n      </table>\n    </div>\n    ");n.innerHTML=a}else n.innerHTML='<div class="alert alert-info">Nenhum contato encontrado.</div>';else console.error("Elemento #contactsList não encontrado.")}},{key:"loadStats",value:(f=l(o().m(function e(){var t,n,a;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.isAuthenticated&&this.authToken){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,fetch("/api/stats",{headers:this.addAuthHeaders()});case 2:return t=e.v,e.n=3,t.json();case 3:(n=e.v).success?(console.log("DEBUG displayStats stats:",n.stats),this.displayStats(n.stats)):this.showError("Erro ao carregar estatísticas"),e.n=5;break;case 4:e.p=4,a=e.v,console.error("Erro ao carregar estatísticas:",a),this.showError("Erro ao carregar estatísticas");case 5:return e.a(2)}},e,this,[[1,4]])})),function(){return f.apply(this,arguments)})},{key:"displayStats",value:function(e){var n=this;if(e){document.getElementById("stats-total-reservations").textContent=e.totalReservations||0,document.getElementById("stats-total-contacts").textContent=e.totalContacts||0,document.getElementById("stats-effectiveness-rate").textContent="".concat(e.effectivenessRate||0,"%"),document.getElementById("stats-conversion-rate").textContent="".concat(e.conversionRate||0,"%"),"number"==typeof e.newReservationsLast30Days&&B("stats-trend-reservations",e.newReservationsLast30Days,{green:10,yellow:1},{green:"Crescimento (+".concat(e.newReservationsLast30Days," este mês)"),yellow:"Estável (+".concat(e.newReservationsLast30Days," este mês)"),red:"Sem novas reservas"}),"number"==typeof e.newContactsLast30Days&&B("stats-trend-contacts",e.newContactsLast30Days,{green:10,yellow:1},{green:"Ótima procura (+".concat(e.newContactsLast30Days," este mês)"),yellow:"Procura moderada (+".concat(e.newContactsLast30Days," este mês)"),red:"Sem novos contatos"}),"number"==typeof e.effectivenessRate&&B("stats-trend-effectiveness",e.effectivenessRate,{green:70,yellow:40},{green:"Alta efetivação",yellow:"Pode melhorar",red:"Baixa efetivação"}),"number"==typeof e.conversionRate&&B("stats-trend-conversion",e.conversionRate,{green:30,yellow:10},{green:"Ótima conversão",yellow:"Conversão razoável",red:"Conversão baixa"});var a=document.getElementById("destination-chart");a&&e.destinationDistribution&&(this.charts.destination&&this.charts.destination.destroy(),this.charts.destination=new Chart(a,{type:"bar",data:{labels:Object.keys(e.destinationDistribution),datasets:[{label:"Reservas",data:Object.values(e.destinationDistribution),backgroundColor:"rgba(59, 130, 246, 0.7)",borderRadius:8,maxBarThickness:32}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{x:{grid:{display:!1},ticks:{color:"#64748b",font:{size:13}}},y:{beginAtZero:!0,grid:{color:"#f1f5f9"},ticks:{color:"#64748b",font:{size:13}}}}}}));var s=document.getElementById("destination-list");if(s&&e.destinationDistribution){var r=Object.entries(e.destinationDistribution).sort(function(e,n){var a=t(e,2)[1];return t(n,2)[1]-a});s.innerHTML=r.length>0?r.map(function(e){var a=t(e,2),s=a[0],r=a[1];return'\n            <div class="data-list-item">\n                <span class="label">'.concat(n.escapeHtml(s),'</span>\n                <span class="value">').concat(r,"</span>\n            </div>\n        ")}).join(""):'<p class="text-muted text-center">Nenhum dado de destino.</p>'}var o=document.getElementById("monthly-chart");o&&e.monthlyDistribution&&e.monthlyDistribution.reservations&&(this.charts&&this.charts.monthlyLine&&this.charts.monthlyLine.destroy(),this.charts=this.charts||{},this.charts.monthlyLine=new Chart(o.getContext("2d"),{type:"line",data:{labels:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],datasets:[{label:"Reservas",data:e.monthlyDistribution.reservations,borderColor:"#2563eb",backgroundColor:"rgba(37, 99, 235, 0.13)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#2563eb",pointBorderColor:"#fff",pointHoverRadius:6}]},options:{plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{color:"#64748b",font:{size:13}}},y:{beginAtZero:!0,grid:{color:"#f1f5f9"},ticks:{color:"#64748b",font:{size:13}}}}}}));var i=document.getElementById("monthly-list");if(i&&e.monthlyDistribution&&e.monthlyDistribution.reservations){var c=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],l=e.monthlyDistribution.reservations.map(function(e,t){return{name:c[t],count:e}}).filter(function(e){return e.count>0});i.innerHTML=l.length>0?l.map(function(e){var t=e.name,n=e.count;return'\n            <div class="data-list-item">\n                <span class="label">'.concat(t,'</span>\n                <span class="value">').concat(n,"</span>\n            </div>\n        ")}).join(""):'<p class="text-muted text-center">Nenhuma reserva este ano.</p>'}var d=document.getElementById("monthly-pie-chart");d&&e.monthlyDistribution&&e.monthlyDistribution.reservations&&(this.charts&&this.charts.monthlyPie&&this.charts.monthlyPie.destroy(),this.charts=this.charts||{},this.charts.monthlyPie=new Chart(d.getContext("2d"),{type:"pie",data:{labels:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],datasets:[{data:e.monthlyDistribution.reservations,backgroundColor:["#2563eb","#1d4ed8","#3b82f6","#60a5fa","#93c5fd","#38bdf8","#0ea5e9","#0284c7","#0369a1","#0e7490","#14b8a6","#22d3ee"]}]},options:{plugins:{legend:{display:!0,position:"bottom"}}}}));var u=document.getElementById("destination-pie-chart");if(u&&e.destinationDistribution){this.charts&&this.charts.destinationPie&&this.charts.destinationPie.destroy(),this.charts=this.charts||{};var m=Object.keys(e.destinationDistribution),v=Object.values(e.destinationDistribution),h=["#2563eb","#10b981","#f59e0b"],f=m.map(function(e,t){return h[t%3]});this.charts.destinationPie=new Chart(u.getContext("2d"),{type:"pie",data:{labels:m,datasets:[{data:v,backgroundColor:f}]},options:{plugins:{legend:{display:!0,position:"bottom"}}}})}var p=document.getElementById("seasonality-indicator");if(p&&e.monthlyDistribution&&e.monthlyDistribution.reservations){var y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],g=e.monthlyDistribution.reservations,b=0,w=-1,k=0;g.forEach(function(e,t){k+=e,e>b&&(b=e,w=t)});var E="";if(w>0){var D=g[w-1];if("number"==typeof D){var L=b-D;L>0?E="<span style='color: var(--success-color); font-weight:600; margin-left:0.5rem;'><i class='fas fa-arrow-up'></i> +".concat(L," vs ").concat(y[w-1],"</span>"):L<0&&(E="<span style='color: var(--danger-color); font-weight:600; margin-left:0.5rem;'><i class='fas fa-arrow-down'></i> ".concat(L," vs ").concat(y[w-1],"</span>"))}}var S=!1;if(e.allYearsMonthlyDistribution){var C=0;for(var T in e.allYearsMonthlyDistribution)e.allYearsMonthlyDistribution[T].forEach(function(e){e>C&&(C=e)});b>=C&&C>0&&(S=!0)}if(b>0&&w>=0){var x=k>0?(b/k*100).toFixed(1):0;p.innerHTML='\n          <style>\n            @keyframes recordFadeIn {\n              0% { opacity: 0; transform: scale(0.95); }\n              100% { opacity: 1; transform: scale(1); }\n            }\n          </style>\n          <div class="seasonality-highlight" style="display: flex; flex-direction: column; align-items: flex-start; justify-content: center; padding: 0.7rem 0 0.6rem 0; width: 100%;">\n            <div style="display: flex; align-items: center; width: 100%; justify-content: space-between;">\n              <div class="month-name" style="font-size: 1.13rem; font-weight: 700; color: var(--dark-color);">'.concat(y[w],'</div>\n            </div>\n            <div class="month-reservations" style="font-size: 0.98rem; color: #64748b; margin-top: 0.32rem; width: 100%; display: flex; align-items: center; gap: 0.6rem;">\n              <span>').concat(b," reservas").concat(x>0?" <span style='color: var(--success-color); font-weight: 600;'>(".concat(x,"% do total)</span>"):"","</span>\n              ").concat(E,"\n            </div>\n            ").concat(S?"<div style='color: var(--primary-color); font-weight: 600; margin-top:0.38rem; width: 100%; animation: recordFadeIn 0.7s cubic-bezier(.4,1.4,.6,1) 1;'>Recorde histórico!</div>":"","\n            <div style='margin-top: 0.5rem; color: #b0b8c9; font-size: 0.85rem; width: 100%;'>O percentual indica a proporção de reservas deste mês em relação ao total do ano.</div>\n          </div>\n        ");var R=p.closest(".content-card");R&&(R.style.cursor="",R.onclick=null)}else p.innerHTML="<div class='empty-state'><i class='fas fa-calendar-times'></i><p>Nenhuma reserva este ano.</p></div>"}var A=document.getElementById("top-destinations-indicator");if(A&&e.destinationDistribution){var M=Object.entries(e.destinationDistribution).sort(function(e,t){return t[1]-e[1]}).slice(0,3);M.length>0?A.innerHTML=M.map(function(e,n){var a=t(e,2),s=a[0],r=a[1];return'\n          <div class="data-list-item" style="display: flex; align-items: center; gap: 1rem;">\n            <span style="font-size: 1.5rem; color: var(--primary-color);"><i class="fas fa-medal"></i> #'.concat(n+1,'</span>\n            <div>\n              <div style="font-weight: 700; font-size: 1.05rem;">').concat(s,'</div>\n              <div style="color: #64748b; font-size: 0.95rem;">').concat(r," reservas</div>\n            </div>\n          </div>\n        ")}).join(""):A.innerHTML="<div class='empty-state'><i class='fas fa-map-marked-alt'></i><p>Nenhum destino registrado.</p></div>"}var j=document.getElementById("loyal-customers-ranking");if(j&&(j.innerHTML="<div style='color: red; font-weight: bold;'>DEBUG: O JS está rodando!</div>"),j&&e.loyalCustomers){console.log("DEBUG loyalCustomers:",e.loyalCustomers);var H=e.loyalCustomers;H.length>0?j.innerHTML='\n          <table class="table table-borderless mb-0 loyal-ranking-table" style="font-size: 0.98rem;">\n            <thead>\n              <tr>\n                <th style="text-align:left;">Cliente</th>\n                <th style="text-align:center;">Reservas</th>\n                <th style="text-align:center; min-width:7em; max-width:12em; white-space:nowrap;">\n                  Última Reserva\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              '.concat(H.sort(function(e,t){return t.count-e.count||(t.lastDate?new Date(t.lastDate):0)-(e.lastDate?new Date(e.lastDate):0)}).slice(0,3).map(function(e,t){return'\n                <tr>\n                  <td style="display:flex; align-items:center; gap:0.5em;">\n                    '.concat(0===t?'<span class="ranking-badge ranking-gold"><i class="fas fa-trophy"></i></span>':1===t?'<span class="ranking-badge ranking-silver"><i class="fas fa-medal"></i></span>':2===t?'<span class="ranking-badge ranking-bronze"><i class="fas fa-medal"></i></span>':"",'\n                    <span class="loyal-customer-name" title="').concat(e.name||e.email||"-",'">').concat(e.name||e.email||"-",'</span>\n                  </td>\n                  <td style="text-align:center;">').concat(e.count,'</td>\n                  <td style="text-align:center;"><span class="loyal-customer-date" title="').concat(e.lastDate?new Date(e.lastDate).toLocaleDateString("pt-BR"):"-",'">').concat(e.lastDate?new Date(e.lastDate).toLocaleDateString("pt-BR"):"-","</span></td>\n                </tr>\n              ")}).join(""),"\n            </tbody>\n          </table>\n        "):j.innerHTML='\n          <div class=\'empty-state\' style="text-align:center;">\n            <i class=\'fas fa-users\' style="font-size:2.2rem; color:var(--border-color);"></i>\n            <p style="margin-top:0.5em; color:#64748b;">\n              Ainda não há clientes recorrentes.<br>\n              Assim que houver, eles aparecerão aqui!\n            </p>\n          </div>\n        '}}function B(e,t,n,a){var s=document.getElementById(e);if(s){s.parentElement.classList.remove("trend-green","trend-yellow","trend-red");var r="trend-green",o="";t>=n.green?(r="trend-green",o=a.green):t>=n.yellow?(r="trend-yellow",o=a.yellow):(r="trend-red",o=a.red),s.parentElement.classList.add(r),s.textContent=o}}}},{key:"viewMessage",value:(m=l(o().m(function e(t){var n,a,s;return o().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/api/contacts/".concat(t),{headers:this.addAuthHeaders()});case 1:return n=e.v,e.n=2,n.json();case 2:(a=e.v).success?this.showMessageModal(a.contact):this.showError("Erro ao carregar mensagem"),e.n=4;break;case 3:e.p=3,s=e.v,console.error("Erro ao carregar mensagem:",s),this.showError("Erro ao carregar mensagem");case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return m.apply(this,arguments)})},{key:"viewReservationDetails",value:(u=l(o().m(function e(t){var n,a,s;return o().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,fetch("/api/reservations/".concat(t),{headers:this.addAuthHeaders()});case 1:return n=e.v,e.n=2,n.json();case 2:(a=e.v).success?this.showReservationModal(a.reservation):this.showError("Erro ao carregar reserva"),e.n=4;break;case 3:e.p=3,s=e.v,console.error("Erro ao carregar reserva:",s),this.showError("Erro ao carregar reserva");case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return u.apply(this,arguments)})},{key:"showMessageModal",value:function(e){if(e&&e.id){var t=document.getElementById("messageModal"),n=t.querySelector(".modal-body");t.querySelector(".modal-title").innerHTML='<i class="fas fa-envelope-open-text" style="margin-right: 0.5em; color: #2563eb; font-size: 1.25em;"></i> Mensagem de '.concat(this.escapeHtml(v(e.name))),n.innerHTML='\n        <dl class="details-list">\n          <div style="grid-column: 1;">\n            <dt><i class="fas fa-user" style="color: #2563eb; margin-right: 0.4em;"></i>Nome</dt>\n            <dd>'.concat(this.escapeHtml(v(e.name)),'</dd>\n          </div>\n          <div style="grid-column: 2;">\n            <dt><i class="fas fa-envelope" style="color: #2563eb; margin-right: 0.4em;"></i>Email</dt>\n            <dd>').concat(this.escapeHtml(v(e.email)),'</dd>\n          </div>\n          <div style="grid-column: 1;">\n            <dt><i class="fas fa-phone" style="color: #2563eb; margin-right: 0.4em;"></i>Telefone</dt>\n            <dd>').concat(this.escapeHtml(v(e.phone)),'</dd>\n          </div>\n          <div style="grid-column: 2;">\n            <dt><i class="fas fa-calendar-alt" style="color: #2563eb; margin-right: 0.4em;"></i>Data</dt>\n            <dd>').concat(e.timestamp||e.date?new Date(e.timestamp||e.date).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",'</dd>\n          </div>\n          <div class="message-row">\n            <dt><i class="fas fa-comment" style="color: #2563eb; margin-right: 0.4em;"></i>Mensagem</dt>\n            <dd class="message-content">').concat(this.escapeHtml(v(e.message)),"</dd>\n          </div>\n        </dl>\n      "),this.showModal("messageModal")}}},{key:"showReservationModal",value:function(e){if(e&&e.id){var t=document.getElementById("reservationModal"),n=t.querySelector(".modal-body");t.querySelector(".modal-title").innerHTML='<i class="fas fa-ship" style="margin-right: 0.5em; color: #2563eb; font-size: 1.25em;"></i> Reserva de '.concat(this.escapeHtml(v(e.name)));var a=v(e.participants||e.guests),s="".concat(a," ").concat(1==a?"pessoa":"pessoas");n.innerHTML='\n        <dl class="details-list reserva-row-3">\n          <div>\n            <dt><i class="fas fa-map-marker-alt" style="color: #2563eb; margin-right: 0.4em;"></i>Destino</dt>\n            <dd>'.concat(this.escapeHtml(v(e.destination)),'</dd>\n          </div>\n          <div>\n            <dt><i class="fas fa-calendar-alt" style="color: #2563eb; margin-right: 0.4em;"></i>Data</dt>\n            <dd>').concat(e.date?new Date(e.date).toLocaleDateString("pt-BR"):"-",'</dd>\n          </div>\n          <div>\n            <dt><i class="fas fa-user-friends" style="color: #2563eb; margin-right: 0.4em;"></i>Participantes</dt>\n            <dd>').concat(s,'</dd>\n          </div>\n        </dl>\n        <dl class="details-list reserva-row-2" style="margin-top:0.5rem;">\n          <div>\n            <dt><i class="fas fa-envelope" style="color: #2563eb; margin-right: 0.4em;"></i>Email</dt>\n            <dd>').concat(this.escapeHtml(v(e.email)),'</dd>\n          </div>\n          <div>\n            <dt><i class="fas fa-info-circle" style="color: #2563eb; margin-right: 0.4em;"></i>Status</dt>\n            <dd><span class="status-badge status-').concat(this.escapeHtml(v(e.status)),'">').concat(this.getStatusText(v(e.status)),'</span></dd>\n          </div>\n        </dl>\n        <dl class="details-list" style="margin-top:0.5rem;">\n          <div>\n            <dt><i class="fas fa-phone" style="color: #2563eb; margin-right: 0.4em;"></i>Telefone</dt>\n            <dd>').concat(this.escapeHtml(v(e.phone)),'</dd>\n          </div>\n          <div>\n            <dt><i class="fas fa-clock" style="color: #2563eb; margin-right: 0.4em;"></i>Solicitado em</dt>\n            <dd>').concat(e.timestamp?new Date(e.timestamp).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-","</dd>\n          </div>\n          ").concat(e.message&&e.message.trim()||e.mensagem&&e.mensagem.trim()?'\n            <div class="message-row">\n              <dt><i class="fas fa-comment-dots" style="color: #2563eb; margin-right: 0.4em;"></i>Mensagem</dt>\n              <dd class="message-content">'.concat(this.escapeHtml(e.message||e.mensagem),"</dd>\n            </div>\n          "):"","\n        </dl>\n      "),this.showModal("reservationModal")}}},{key:"deleteItem",value:(c=l(o().m(function e(t,n){var a,s,r,i,c,l,d,u;return o().w(function(e){for(;;)switch(e.n){case 0:if(a=document.getElementById("confirmationModal")){e.n=1;break}return e.a(2);case 1:if(s=t.toString(),a.dataset.id=s,a.dataset.type=n,r=a.querySelector(".modal-title"),i=a.querySelector(".confirmation-message"),r&&i){e.n=2;break}return console.error("Estrutura do modal de confirmação está incorreta."),e.a(2);case 2:c="reservation"===n?"a reserva":"o contato",l="",(d=document.querySelector('tr[data-id="'.concat(s,'"]')))&&(l=null===(u=d.querySelector("td:first-child"))||void 0===u?void 0:u.textContent),r.textContent="Confirmar Exclusão",i.innerHTML="Você tem certeza que deseja excluir ".concat(c," de <strong>").concat(this.escapeHtml(l||"ID ".concat(s)),"</strong>? <br><br>Esta ação não poderá ser desfeita."),this.showModal("confirmationModal");case 3:return e.a(2)}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"showModal",value:function(e){var t=document.getElementById(e);t&&(t.style.display="flex",setTimeout(function(){t.classList.add("show");var e=t.querySelector(".modal-content");e&&e.classList.add("show")},10))}},{key:"closeModal",value:function(e){var t=document.getElementById(e);if(t){t.classList.remove("show");var n=t.querySelector(".modal-content");n&&n.classList.remove("show"),setTimeout(function(){t.style.display="none"},300)}}},{key:"performDelete",value:(i=l(o().m(function e(t,n){var a,s=this;return o().w(function(e){for(;;)switch(e.n){case 0:if(this.closeModal("confirmationModal"),"reservation"!==n){e.n=2;break}return e.n=1,this.deleteReservation(t);case 1:a=e.v,this.closeModal("reservationModal"),e.n=4;break;case 2:if("contact"!==n){e.n=4;break}return e.n=3,this.deleteContact(t);case 3:a=e.v;case 4:a&&a.success?(this.showSuccess("Item excluído com sucesso!"),"reservation"===n?setTimeout(l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,s.loadReservations();case 1:return e.n=2,s.loadDashboard();case 2:return e.a(2)}},e)})),200):"contact"===n&&setTimeout(l(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,s.loadContacts();case 1:return e.a(2)}},e)})),200)):this.showError(a&&a.message?a.message:"Erro ao excluir item");case 5:return e.a(2)}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"deleteReservation",value:(r=l(o().m(function e(t){var n,a,s;return o().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return this.showError("ID da reserva inválido."),e.a(2,null);case 1:return e.p=1,e.n=2,fetch("/api/reservations/".concat(t),{method:"DELETE",headers:this.addAuthHeaders()});case 2:if((n=e.v).ok){e.n=4;break}return e.n=3,n.json().catch(function(){return{}});case 3:throw a=e.v,new Error(a.message||"Erro ".concat(n.status));case 4:return e.n=5,n.json();case 5:return e.a(2,e.v);case 6:return e.p=6,s=e.v,console.error("Erro ao deletar reserva ".concat(t,":"),s),this.showError("Falha ao deletar reserva: ".concat(s.message)),e.a(2,null)}},e,this,[[1,6]])})),function(e){return r.apply(this,arguments)})},{key:"deleteContact",value:(a=l(o().m(function e(t){var n,a,s;return o().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return this.showError("ID do contato inválido."),e.a(2,null);case 1:return e.p=1,e.n=2,fetch("/api/contacts/".concat(t),{method:"DELETE",headers:this.addAuthHeaders()});case 2:if((n=e.v).ok){e.n=4;break}return e.n=3,n.json().catch(function(){return{}});case 3:throw a=e.v,new Error(a.message||"Erro ".concat(n.status));case 4:return e.n=5,n.json();case 5:return e.a(2,e.v);case 6:return e.p=6,s=e.v,console.error("Erro ao deletar contato ".concat(t,":"),s),this.showError("Falha ao deletar contato: ".concat(s.message)),e.a(2,null)}},e,this,[[1,6]])})),function(e){return a.apply(this,arguments)})},{key:"showSuccess",value:function(e){window.showSuccessMessage("Sucesso",e)}},{key:"showError",value:function(e){window.showErrorMessage("Erro",e)}},{key:"escapeHtml",value:function(e){return"string"!=typeof e?"":e.replace(/[&<>"']/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]})}},{key:"getStatusText",value:function(e){return{pendente:"Pendente",confirmada:"Confirmada",cancelada:"Cancelada"}[e]||e}}],n&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,a,r,i,c,u,m,f,p,y,g,b,w,k,E,D,L}();function v(e){return null==e?"-":e}function h(e){return void 0===e.guests&&void 0!==e.participants&&(e.guests=e.participants),e}document.addEventListener("DOMContentLoaded",function(){var e=new m;e.initAuth(),window.adminPanel=e})})();
//# sourceMappingURL=admin.bundle.js.map